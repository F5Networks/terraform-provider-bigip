<!DOCTYPE html>
<head>
  
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PPZPQ6');</script>
  <!-- End Google Tag Manager -->
    <title>Scenario #5: Managing an F5 BIG-IP Advanced WAF Policy with Policy Builder on a single device</title>
  

  <meta charset="utf-8">
  <!-- Twitter Bootstrap viewport setting -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- F5 metadata -->
  <meta name="title" content="Scenario #5: Managing an F5 BIG-IP Advanced WAF Policy with Policy Builder on a single device"/>
  <meta name="product" content="F5 BIG-IP Resources for Terraform"/>
  <meta name="version" content=""/>
  <meta name="updated_date"  content="2023-04-26 11:52:19"/>
  <meta name="archived" content="Archived documents excluded"/>
  <meta name="doc_type" content="Manual"/>
  <meta name="lifecycle" content="release"/>
  <meta name="F5 BIG-IP Resources for Terraform" content=""/>


  

  
  <link href="https://cdn.f5.com/favicon.ico" rel="icon">

</head>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Scenario #5: Managing an F5 BIG-IP Advanced WAF Policy with Policy Builder on a single device &#8212; F5 Modules for Terraform</title>
    <link rel="stylesheet" href="../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/table_styling.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/f5.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/f5-theme.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="https://use.fontawesome.com/21fb8a09c3.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <script type="text/javascript" src="../../_static/copybutton.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Scenario #6: Managing an F5 BIG-IP Advanced WAF Policy with Policy Builder on multiple devices" href="awaf-policybuildermultiple.html" />
    <link rel="prev" title="Scenario #4: Managing an F5 BIG-IP Advanced WAF Policy on different devices" href="awaf-multiple.html" />

  
    

  
  </head><body>
  <div id="clouddocs-header"></div>

    <div id="dismiss">
      <button type="button" class="btn btn-info navbar-btn site-hidden">
        <i class="fa fa-align-justify"></i>
      </button>
    </div>
    <div id="sidebar" class="section-nav">
      
      <!--  version selector ------------------>
      <div id="version_selector_wrapper">
      </div>
      <nav class="nav-sidebartoc">

        
         <h5>F5 BIG-IP Resources for Terraform  </h5>
        
<div id="searchbox" role="search">
  <form class="search" action="../../search.html" method="get">
    <input type="text" class="search" name="q" placeholder=" Search..." />
    <button type="submit" class="btn btn-info navbar-btn"><i class="fa fa-search"></i></button>
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        <hr>
        <span class="nav-sidebartoc">
            <p class="caption"><span class="caption-text">F5 Terraform Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">F5 Terraform Resources Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installing.html">Installing Terraform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuring.html">Configuring Terraform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../support.html">Support</a></li>
</ul>
<p class="caption"><span class="caption-text">F5 BIG-IP Provider</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index-bigip.html">F5 BIG-IP Provider Overview</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index-bigip.html#releases-and-versioning">Releases and Versioning</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../release-notes.html">F5 BIG-IP Provider Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bigip-modules/index.html">F5 BIG-IP Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../as3-integration.html">AS3 Integration with Terraform</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Advanced WAF Integration with Terraform</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#example-usage">Example Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#integration-resources-and-data-sources">Integration Resources and Data Sources</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#quickstart-and-lab-guides">Quickstart and Lab Guides</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../fast-integration/index.html">FAST Integration with Terraform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../do-integration.html">Declarative Onboarding Integration with Terraform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bigiq-licensing.html">Licensing BIG-IP with BIG-IQ</a></li>
</ul>
<p class="caption"><span class="caption-text">F5OS Provider</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../F5OS/index-f5os.html">F5OS Resources for Terraform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../F5OS/release-notes.html">F5OS Provider Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../F5OS/f5os-modules.html">F5OS Tenant Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../F5OS/f5os-qsg.html">F5OS Quick Start Guide</a></li>
</ul>

        </span><!-- Use this file to add extra links to the bottom of the ToC sidebar -->
<hr>
  <span class="nav-sidebartoc">
 <!-- insert content here -->
  </span>
      </nav>
    </div>


    <div id="right-sidebar">
      <h7 style="font-weight:normal">On this page:</h7>
      <nav class="nav-sidebartoc">
        <span class="nav-sidebartoc">
            <ul>
<li><a class="reference internal" href="#">Scenario #5: Managing an F5 BIG-IP Advanced WAF Policy with Policy Builder on a single device</a><ul>
<li><a class="reference internal" href="#pre-requisites">Pre-requisites</a></li>
<li><a class="reference internal" href="#policy-creation">Policy Creation</a></li>
<li><a class="reference internal" href="#simulate-a-waf-policy-workflow">Simulate a WAF Policy workflow</a><ul>
<li><a class="reference internal" href="#change-the-policy-builder-process-for-testing-and-demo-purpose-only">Change the Policy Builder process (for testing and demo purpose only):</a></li>
<li><a class="reference internal" href="#browse-the-vulnerable-application">Browse the Vulnerable Application</a></li>
<li><a class="reference internal" href="#check-learning-suggestions">Check Learning Suggestions</a></li>
</ul>
</li>
</ul>
</li>
</ul>

         </span>
      </nav>
    </div>





  
  <div class="main active" id="content" >
    <article class="docs-container site-article-inner">
            <nav class="site-breadcrumb-nav site-nav">
          <ul class="site-breadcrumb-list">
            <li class="breadcrumb-item"><button type="button" id="sidebarCollapse" class="btn btn-info navbar-btn site-hidden"><i class="fa fa-align-justify"></i></button>&#x20 <a href="/">CloudDocs Home</a> &gt; <a href="../../index.html">F5 BIG-IP Resources for Terraform </a> &gt; Scenario #5: Managing an F5 BIG-IP Advanced WAF Policy with Policy Builder on a single device</li>
          </ul>
      </nav>
      
      


    <!--a title="Export PDF" id="export-pdf" class="btn btn btn-link pull-right">View PDF</a-->
    <button type="button" id="export-pdf" class="btn btn-link right">PDF</button>


    
     
         <div class="sidebar" id="version-warning" style="display: none;">
           <p class="first sidebar-title">
           <span class="icon fa fa-info-circle fa-lg"></span> Version notice:</p>
           <p class="last" id="currentVersion"></p>
          </div>


     <div role="main">
        
  <div class="section" id="scenario-5-managing-an-f5-big-ip-advanced-waf-policy-with-policy-builder-on-a-single-device">
<span id="awaf-policybuildersingle"></span><h1>Scenario #5: Managing an F5 BIG-IP Advanced WAF Policy with Policy Builder on a single device<a class="headerlink" href="#scenario-5-managing-an-f5-big-ip-advanced-waf-policy-with-policy-builder-on-a-single-device" title="Permalink to this headline">¶</a></h1>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference external" href="https://github.com/fchmainy/awaf_tf_docs/tree/main/5.policyBuilderSingle">https://github.com/fchmainy/awaf_tf_docs/tree/main/5.policyBuilderSingle</a></p>
</div>
<p>The goal of this lab is to manage Policy Builder Suggestions an F5 BIG-IP Advanced WAF Policy on a single device or cluster. As the traffic flows through the BIG-IP, it is easy to manage suggestions from the Policy Builder and enforce them on the WAF Policy. It also shows the potential management workflow:</p>
<ul class="simple">
<li>The security engineer regularly checks the sugestions directly on the BIG-IP WebUI and cleans the irrelevant suggestions.</li>
<li>Once the cleaning is done, the Terraform engineer (who can also be the security engineer) issues a Terraform apply for the current suggestions. You can filter the suggestions on their scoring level (from 5% to 100%, with 100% being the highest confidence level).</li>
<li>Every suggestions application can be tracked on Terraform and can easily be roll-backed if needed.</li>
</ul>
<div class="section" id="pre-requisites">
<h2>Pre-requisites<a class="headerlink" href="#pre-requisites" title="Permalink to this headline">¶</a></h2>
<p>On the BIG-IP:</p>
<ul class="simple">
<li>BIG-IP version 16.1 or newer</li>
<li>Advanced WAF Provisioned</li>
<li>Credentials with REST API access</li>
<li>An Advanced WAF Policy with Policy Builder enabled and Manual traffic Learning</li>
</ul>
<p>On Terraform:</p>
<ul class="simple">
<li>Using F5 BIG-IP provider version 1.15.0 or newer</li>
<li>Using Hashicorp versions following <a class="reference internal" href="../index-bigip.html#versions"><span class="std std-ref">Releases and Versioning</span></a></li>
</ul>
</div>
<div class="section" id="policy-creation">
<h2>Policy Creation<a class="headerlink" href="#policy-creation" title="Permalink to this headline">¶</a></h2>
<p>F5 has already exported a WAF Policy called scenario5.json available <a class="reference external" href="https://raw.githubusercontent.com/fchmainy/awaf_tf_docs/main/0.Appendix/scenario5_wLearningSuggestions.json">here</a> including several Policy Builder Suggestions so you won’t have to generate traffic.</p>
<p>Create 4 files:</p>
<ul class="simple">
<li>variables.tf</li>
<li>inputs.auto.tfvars</li>
<li>main.tf</li>
<li>outputs.tf</li>
</ul>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">variables.tf</span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-json notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span>variable prod_bigip {}
variable username {}
variable password {}
</pre></div>
</td></tr></table></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">inputs.auto.tfvars</span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-json notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span>prod_bigip = &quot;10.1.1.8:443&quot;
username = &quot;admin&quot;
password = &quot;whatIsYourBigIPPassword?&quot;
</pre></div>
</td></tr></table></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">main.tf</span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-json notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre></div></td><td class="code"><div class="highlight"><pre><span></span>terraform {
  required_providers {
    bigip = {
      source = &quot;F5Networks/bigip&quot;
      version = &quot;1.15&quot;
    }
  }
}

provider &quot;bigip&quot; {
  alias    = &quot;prod&quot;
  address  = var.prod_bigip
  username = var.username
  password = var.password
}

data &quot;http&quot; &quot;scenario5&quot; {
  url = &quot;https://raw.githubusercontent.com/fchmainy/awaf_tf_docs/main/0.Appendix/Common_scenario5__2022-8-12_15-49-28__prod1.f5demo.com.json&quot;
  request_headers = {
     Accept = &quot;application/json&quot;
  }
}

resource &quot;bigip_waf_policy&quot; &quot;this&quot; {
    provider            = bigip.prod
    application_language = &quot;utf-8&quot;
    partition            = &quot;Common&quot;
    name                 = &quot;scenario5&quot;
    template_name        = &quot;POLICY_TEMPLATE_FUNDAMENTAL&quot;
    type                 = &quot;security&quot;
    policy_import_json   = data.http.scenario5.body
}
</pre></div>
</td></tr></table></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The template name can be set to anything. When it is imported, the value is overwritten.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">outputs.tf</span><a class="headerlink" href="#id4" title="Permalink to this code">¶</a></div>
<div class="highlight-json notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span>output &quot;policyId&quot; {
     value   = bigip_waf_policy.this.policy_id
}

output &quot;policyJSON&quot; {
        value   = bigip_waf_policy.this.policy_export_json
}
</pre></div>
</td></tr></table></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Initialize, plan, and apply your new Terraform project:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>foo@bar:~$ terraform init

foo@bar:~$ terraform plan -out scenario5

foo@bar:~$ terraform apply &quot;scenario5&quot;
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Log on to your F5 BIG-IP UI and associate the Advanced WAF Policy <strong>scenario5</strong> to the Virtual Server <strong>scenario5.vs</strong>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The Virtual Server and the whole application service can be automated using the BIG-IP provider with the AS3 or FAST resources.</p>
</div>
</div>
<div class="section" id="simulate-a-waf-policy-workflow">
<h2>Simulate a WAF Policy workflow<a class="headerlink" href="#simulate-a-waf-policy-workflow" title="Permalink to this headline">¶</a></h2>
<div class="section" id="change-the-policy-builder-process-for-testing-and-demo-purpose-only">
<h3>Change the Policy Builder process (for testing and demo purpose only):<a class="headerlink" href="#change-the-policy-builder-process-for-testing-and-demo-purpose-only" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Go to the DVWA WAF Policy on your BIG-IP TMUI (if you are using UDF, the WAF policy is called scenario5 and is located under the Common partition.</li>
<li>In the <span class="guilabel">Learning and blocking Settings</span> (<span class="guilabel">Security &gt; Application Security : Policy Building : Learning and Blocking Settings</span>), at the very bottom of the page, go on the <span class="guilabel">Loosen Policy</span> settings in the Advanced view of the <span class="guilabel">Policy Building Process</span>.</li>
<li>Change the <span class="guilabel">different sources, spread out over a time period of at least</span> value from <span class="guilabel">10</span> to <span class="guilabel">1</span> so the policy builder generates learning suggestions more rapidly.</li>
</ol>
</div>
<div class="section" id="browse-the-vulnerable-application">
<h3>Browse the Vulnerable Application<a class="headerlink" href="#browse-the-vulnerable-application" title="Permalink to this headline">¶</a></h3>
<p>Now browse the DVWA web application through the F5 BIG-IP Advanced WAF Virtual Server. The credentials to log in to DVWA are admin/password.</p>
<ol class="arabic simple">
<li>Go on the <span class="guilabel">DVWA Security</span> menu and change the level to <span class="guilabel">Low</span> then <span class="guilabel">Submit</span>.</li>
<li>Browse the DVWA website by clicking into any menus.</li>
<li>Generate some attacks:<ul>
<li><code class="docutils literal notranslate"><span class="pre">SQL</span> <span class="pre">Injection:</span> <span class="pre">%'</span> <span class="pre">or</span> <span class="pre">1='1</span> <span class="pre">'</span> <span class="pre">and</span> <span class="pre">1=0</span> <span class="pre">union</span> <span class="pre">select</span> <span class="pre">null,</span> <span class="pre">concat(first_name,0x0a,last_name,0x0a,user,0x0a,password)</span> <span class="pre">from</span> <span class="pre">users</span> <span class="pre">#</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">XSS</span> <span class="pre">Reflected:</span> <span class="pre">&lt;script&gt;alert('hello')&lt;/script&gt;</span></code></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="check-learning-suggestions">
<h3>Check Learning Suggestions<a class="headerlink" href="#check-learning-suggestions" title="Permalink to this headline">¶</a></h3>
<p>If you go to the WAF Policy learning suggestions, you will find multiple suggestions with a high score of 100% (because we have not been picky in the learning process settings).</p>
<p>Here is a typical workflow in real life:</p>
<ul class="simple">
<li>The security engineer regularly checks the sugestions directly on the BIG-IP WebUI and cleans the irrelevant suggestions.</li>
<li>Once the cleaning is done, the Terraform engineer (can either be the same person or different) creates a unique bigip_waf_pb_suggestions data source before issuing a Terraform apply for the current suggestions. You can filter the suggestions on their scoring level (from 5% to 100% with 100% having the highest confidence level).</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Every suggestions application can be tracked on Terraform and can easily be roll-backed if needed.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ol class="arabic">
<li><p class="first">Go to your BIG-IP WebUI and clean the irrelevant suggestions.</p>
<p>For example, remove all the suggestions with a scoring = 1%</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">You can ignore suggestions but you should never accept them on the WebUI, otherwise you will then have to reconciliate the changes between the WAF Policy on the BIG-IP and the latest known WAF Policy in your Terraform state.</p>
</div>
</li>
<li><p class="first">Use Terraform to enforce the policy builder suggestions.</p>
<ol class="loweralpha">
<li><p class="first">Create a <strong>suggestions.tf</strong> file. The name of the bigip_waf_pb_suggestions data source should be unique so we can track what modifications have been enforced and when.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="s2">&quot;bigip_waf_pb_suggestions&quot;</span> <span class="s2">&quot;AUG3rd20221715&quot;</span> <span class="p">{</span>
  <span class="n">provider</span>                <span class="o">=</span> <span class="n">bigip</span><span class="o">.</span><span class="n">prod</span>
  <span class="n">policy_name</span>            <span class="o">=</span> <span class="s2">&quot;scenario5&quot;</span>
  <span class="n">partition</span>              <span class="o">=</span> <span class="s2">&quot;Common&quot;</span>
  <span class="n">minimum_learning_score</span> <span class="o">=</span> <span class="mi">100</span>
<span class="p">}</span>

<span class="n">output</span> <span class="s2">&quot;AUG3rd20221715&quot;</span> <span class="p">{</span>
       <span class="n">value</span>   <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">bigip_waf_pb_suggestions</span><span class="o">.</span><span class="n">AUG3rd20221715</span><span class="o">.</span><span class="n">json</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>You can check the suggestions before they are applied to the BIG-IP:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>foo@bar:~$ terraform plan -out scenario5

foo@bar:~$ terraform apply &quot;scenario5&quot;

foo@bar:~$ terraform output AUG3rd20221715 | jq &#39;. | fromjson&#39;
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>You will get the JSON list of suggestions that have a learning score of 100%.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;suggestions&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;update-append&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Add/Update Parameter. Disable the matched signature on the matched Parameter&quot;</span><span class="p">,</span>
        <span class="s2">&quot;entity&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;level&quot;</span><span class="p">:</span> <span class="s2">&quot;global&quot;</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;id&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;entityChanges&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;signatureOverrides&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
              <span class="s2">&quot;enabled&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
              <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;SQL-INJ &#39; UNION SELECT (Parameter)&quot;</span><span class="p">,</span>
              <span class="s2">&quot;signatureId&quot;</span><span class="p">:</span> <span class="mi">200002736</span>
            <span class="p">}</span>
          <span class="p">],</span>
          <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;explicit&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;entityType&quot;</span><span class="p">:</span> <span class="s2">&quot;parameter&quot;</span>
      <span class="p">},</span>
<span class="p">[</span><span class="o">...</span><span class="p">],</span>
      <span class="p">{</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;add-or-update&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Add Policy Server Technology&quot;</span><span class="p">,</span>
        <span class="s2">&quot;entity&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;serverTechnologyName&quot;</span><span class="p">:</span> <span class="s2">&quot;Unix/Linux&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;entityType&quot;</span><span class="p">:</span> <span class="s2">&quot;server-technology&quot;</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
</pre></div>
</div>
</li>
<li><p class="first">Update the <strong>main.tf</strong> file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">resource</span> <span class="s2">&quot;bigip_waf_policy&quot;</span> <span class="s2">&quot;this&quot;</span> <span class="p">{</span>
    <span class="n">provider</span>             <span class="o">=</span> <span class="n">bigip</span><span class="o">.</span><span class="n">prod</span>
    <span class="n">application_language</span> <span class="o">=</span> <span class="s2">&quot;utf-8&quot;</span>
    <span class="n">partition</span>            <span class="o">=</span> <span class="s2">&quot;Common&quot;</span>
    <span class="n">name</span>                 <span class="o">=</span> <span class="s2">&quot;scenario5&quot;</span>
    <span class="n">template_name</span>        <span class="o">=</span> <span class="s2">&quot;POLICY_TEMPLATE_FUNDAMENTAL&quot;</span>
    <span class="nb">type</span>                 <span class="o">=</span> <span class="s2">&quot;security&quot;</span>
    <span class="n">policy_import_json</span>   <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">scenario5</span><span class="o">.</span><span class="n">body</span>
    <span class="n">modifications</span>        <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">bigip_waf_pb_suggestions</span><span class="o">.</span><span class="n">AUG3rd20221715</span><span class="o">.</span><span class="n">json</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p class="first">Plan and apply:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>foo@bar:~$ terraform plan -out scenario5

foo@bar:~$ terraform apply &quot;scenario5&quot;
</pre></div>
</div>
</li>
</ol>
<p>Check on the BIG-IP UI that the server technologies and other suggestions have been succesfully enforced to your WAF Policy.</p>
</li>
</ol>
<p>What’s Next?</p>
<ul class="simple">
<li><a class="reference internal" href="awaf-create.html#awaf-create"><span class="std std-ref">Create a WAF policy</span></a></li>
<li><a class="reference internal" href="awaf-import.html#awaf-import"><span class="std std-ref">Manage existing WAF policy</span></a></li>
<li><a class="reference internal" href="awaf-migrate.html#awaf-migrate"><span class="std std-ref">Migrate WAF policy from one BIG-IP to another</span></a></li>
<li><a class="reference internal" href="awaf-multiple.html#awaf-multiple"><span class="std std-ref">Manage WAF policies for multiple devices</span></a></li>
<li><a class="reference internal" href="awaf-policybuildermultiple.html#awaf-policybuildermultiple"><span class="std std-ref">Using WAF policy builder to manage multiple devices</span></a></li>
<li><a class="reference internal" href="../release-notes.html#release-notes"><span class="std std-ref">Release Notes</span></a></li>
</ul>
</div>
</div>
</div>


     </div>
    
     <div class="row next-prev-btn-row">
       <div class="col-lg-12">
       
        <a href="awaf-multiple.html" title="Scenario #4: Managing an F5 BIG-IP Advanced WAF Policy on different devices" accesskey="p" class="btn btn-primary left"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous</a>
       
       
          <a href="awaf-policybuildermultiple.html" title="Scenario #6: Managing an F5 BIG-IP Advanced WAF Policy with Policy Builder on multiple devices" accesskey="n" class="btn btn-primary right">Next <i class="fa fa-arrow-circle-right" aria-hidden="true"></i></a>
       
     </div>
     </div>
    

    </article>
  </div>

</div>


  <div id="clouddocs-footer"></div>
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->

  <script src="../../_static/js/index.js"></script>
  <script src="../../_static/js/bootstrap.min.js"></script>
  <script src="../../_static/js/clouddocs.js"></script>
  <script src="../../_static/js/jquery.appear.js"></script>
  <script src="../../_static/js/printThis.js"></script>
  </body>
</html>